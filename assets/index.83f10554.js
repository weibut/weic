var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,i=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{o as n,a as r,d,F as c,q as u,L as p,M as f,g as m,f as g,r as b,aB as h,aC as y,b6 as v,j as w,u as x,k as _,aJ as V,m as I,b7 as k,h as T,s as A,R as C,T as P,c as F,H as D,t as j,N as q,x as U,b as B,l as S,p as O,b8 as L}from"./vendor.d7d62f29.js";import{u as E,e as K}from"./main.0c516264.js";import{_ as z}from"./d-dialog.742c36de.js";import{_ as M,e as N,a as R,l as H,A as J,S as G,g as Q,v as W,x as X}from"./d-text-icon.995c3277.js";import"./el-radio.1c676c39.js";const Y="function"==typeof btoa,Z="function"==typeof Buffer;"function"==typeof TextDecoder&&new TextDecoder;const $="function"==typeof TextEncoder?new TextEncoder:void 0,ee=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=");(e=>{let a={};ee.forEach(((e,l)=>a[e]=l))})();const ae=String.fromCharCode.bind(String);"function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array);const le=Y?e=>btoa(e):Z?e=>Buffer.from(e,"binary").toString("base64"):e=>{let a,l,t,s,o="";const i=e.length%3;for(let n=0;n<e.length;){if((l=e.charCodeAt(n++))>255||(t=e.charCodeAt(n++))>255||(s=e.charCodeAt(n++))>255)throw new TypeError("invalid character found");a=l<<16|t<<8|s,o+=ee[a>>18&63]+ee[a>>12&63]+ee[a>>6&63]+ee[63&a]}return i?o.slice(0,i-3)+"===".substring(i):o},te=Z?e=>Buffer.from(e).toString("base64"):e=>{let a=[];for(let l=0,t=e.length;l<t;l+=4096)a.push(ae.apply(null,e.subarray(l,l+4096)));return le(a.join(""))},se=e=>{if(e.length<2)return(a=e.charCodeAt(0))<128?e:a<2048?ae(192|a>>>6)+ae(128|63&a):ae(224|a>>>12&15)+ae(128|a>>>6&63)+ae(128|63&a);var a=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return ae(240|a>>>18&7)+ae(128|a>>>12&63)+ae(128|a>>>6&63)+ae(128|63&a)},oe=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,ie=Z?e=>Buffer.from(e,"utf8").toString("base64"):$?e=>te($.encode(e)):e=>le(e.replace(oe,se)),ne=(e,a=!1)=>a?(e=>e.replace(/=/g,"").replace(/[+\/]/g,(e=>"+"==e?"-":"_")))(ie(e)):ie(e);const re={class:"d-flex-between login-third"},de=(e=>(p("data-v-2df4f6f9"),e=e(),f(),e))((()=>d("div",null,"第三方账号登录",-1))),ce={class:"d-flex"},ue=["href","onClick"],pe=["src"];var fe=M({emits:["loginThird"],setup(e,{emit:a}){const l=[{url:"https://api.weibo.com/oauth2/authorize?client_id=3805380913&redirect_uri=https://www.codelife.cc/logincb&response_type=code&state=&scope=all",icon:"weibo"},{url:"https://graph.qq.com/oauth2.0/show?which=Login&display=pc&response_type=code&client_id=101983660&redirect_uri=https%3A%2F%2Fwww.codelife.cc%2Flogincb&state=qq",icon:"qq"},{url:"https://github.com/login/oauth/authorize?client_id=930860aee1b7c1ce56ee&scope=user",icon:"github"}];return(e,t)=>(n(),r("div",re,[de,d("div",ce,[(n(),r(c,null,u(l,(e=>d("span",{href:e.url,key:e.icon,onClick:l=>(e=>{window.open(e.url,"_blank","width=800,height=500"),window.addEventListener("message",(e=>{let l=e.data||{};a("loginThird",l)}),!1)})(e)},[d("img",{style:{width:"24px",height:"24px"},src:`./login/${e.icon}.svg`},null,8,pe)],8,ue))),64))])]))}},[["__scopeId","data-v-2df4f6f9"]]);const me=e=>(p("data-v-28ad61fa"),e=e(),f(),e),ge=[me((()=>d("span",{class:"brid-body"},null,-1))),me((()=>d("span",{class:"brid-claw left"},null,-1))),me((()=>d("span",{class:"brid-claw right"},null,-1)))];var be=M({props:{inputPass:{type:Boolean,defautl:!1}},setup(e){const a=e;return(e,l)=>(n(),r("div",null,[d("div",{class:m(["login-bird",{password:a.inputPass}])},ge,2)]))}},[["__scopeId","data-v-28ad61fa"]]);const he=e=>(p("data-v-1a8bd1ac"),e=e(),f(),e),ye=he((()=>d("div",{class:"ar",style:{margin:"-15px 0 10px 0"}},[d("a",{class:"d-main f12",target:"_blank",href:"https://codelife.cc/account/pass?type=find"},"忘记密码")],-1))),ve=A("立即登录"),we=he((()=>d("div",null,[d("h2",{class:"ac f18 mb10 pt30"},"选择账号数据")],-1))),xe=he((()=>d("p",{class:"f12 d-sub ac"}," 检测到云端数据和本地数据不一致，请选择使用其中某一项数据 ",-1))),_e={style:{padding:"20px 40px 40px"}},Ve=A("使用本地数据"),Ie=A("使用云端数据"),ke={class:"ac mt30"},Te=A("确定");var Ae=M({setup(e){const a=E(),l=N(),t=g({email:"",password:""}),s=g({loading:!1,userInfo:{},selectDataVisible:!1,dataActive:2,isInputPass:!1}),o=b(null),i=()=>{s.loading=!0;let e={};e.email=t.email,e.from="itab",e.password=ne(t.password),e.t=(new Date).getTime(),R.userLogin(e).then((e=>{200==e.code&&c(e)})).finally((()=>{s.loading=!1}))};function c(e){s.userInfo=e.data||{},s.userInfo.token=e.token;let t=!1;s.userInfo.upTime&&(t=!0);for(let a in s.userInfo.itabAsyncTime)1!=s.userInfo.itabAsyncTime[a]&&(t=!0);t?(a.loginInfo.visible=!0,s.selectDataVisible=!0):(l.value=s.userInfo,H.set("token",s.userInfo.token),a.loginInfo.visible=!1)}function u(){l.value=s.userInfo,H.set("token",s.userInfo.token),2==s.dataActive?J(null,s.userInfo.itabAsyncTime):G(null),s.selectDataVisible=!1,a.loginInfo.visible=!1}return(e,a)=>{const l=C,p=h,f=Q,m=y,g=v,b=P;return n(),r("div",null,[w(be,{inputPass:x(s).isInputPass},null,8,["inputPass"]),w(m,{onSubmit:a[4]||(a[4]=T((()=>{}),["prevent"])),size:"medium",model:x(t),ref_key:"refLoginForm",ref:o,"label-position":"right"},{default:_((()=>[w(p,{prop:"email",rules:{required:!0,type:"email",message:"邮箱格式不正确"}},{default:_((()=>[w(l,{"prefix-icon":x(V),maxlength:"40",modelValue:x(t).email,"onUpdate:modelValue":a[0]||(a[0]=e=>x(t).email=e),placeholder:"请输入邮箱"},null,8,["prefix-icon","modelValue"])])),_:1}),w(p,{prop:"password",rules:{required:!0,message:"密码不能为空"}},{default:_((()=>[w(l,{onKeydown:I(i,["enter"]),maxlength:"20","show-password":"","prefix-icon":x(k),type:"password",modelValue:x(t).password,"onUpdate:modelValue":a[1]||(a[1]=e=>x(t).password=e),onFocus:a[2]||(a[2]=e=>x(s).isInputPass=!0),onBlur:a[3]||(a[3]=e=>x(s).isInputPass=!1),placeholder:"请输入6-18位密码"},null,8,["onKeydown","prefix-icon","modelValue"])])),_:1}),ye,w(f,{onClick:i,type:"primary",class:"wfull mb20",loading:x(s).loading},{default:_((()=>[ve])),_:1},8,["loading"])])),_:1},8,["model"]),w(fe,{onLoginThird:c}),w(b,{"append-to-body":!0,width:"400px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,modelValue:x(s).selectDataVisible,"onUpdate:modelValue":a[7]||(a[7]=e=>x(s).selectDataVisible=e)},{default:_((()=>[we,xe,d("div",_e,[d("p",null,[w(g,{modelValue:x(s).dataActive,"onUpdate:modelValue":a[5]||(a[5]=e=>x(s).dataActive=e),label:1},{default:_((()=>[Ve])),_:1},8,["modelValue"])]),d("p",null,[w(g,{modelValue:x(s).dataActive,"onUpdate:modelValue":a[6]||(a[6]=e=>x(s).dataActive=e),label:2},{default:_((()=>[Ie])),_:1},8,["modelValue"])]),d("p",ke,[w(f,{onClick:u,class:"wfull",type:"primary"},{default:_((()=>[Te])),_:1})])])])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-1a8bd1ac"]]);const Ce={class:"d-flex-between"},Pe=A("立即注册"),Fe={setup(e){const c=N(),u=E(),p=g({timer:null,loading:!1,timerText:"获取验证码",setp:0,isInputPass:!1}),f=g({email:"",username:"",password:"",verifyKey:"",source:W()}),m=b(null);const v=F((()=>!X(f.email)));F((()=>!X(f.email)));const V=()=>{X(f.email)?(p.timerText=10,p.timer=setInterval((()=>{p.timerText--,p.timerText<=0&&(clearInterval(p.timer),p.timerText="获取验证码")}),1e3),R.userSendVerifyCode({email:f.email}).then((e=>{q.success("验证码发送成功")}))):q.warning("请输入正确的邮箱")};function I(){m.value.validate((e=>{if(!e)return;p.loading=!0;let n=(r=((e,a)=>{for(var l in a||(a={}))s.call(a,l)&&i(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&i(e,l,a[l]);return e})({},f),d={password:ne(f.password)},a(r,l(d)));var r,d;n.t=(new Date).getTime(),R.userRegistry(n).then((e=>{let a=e.data||{};c.value=a,H.set("token",e.token),q.success("注册成功"),u.loginInfo.visible=!1})).finally((()=>{p.loading=!1}))}))}return D((()=>{clearInterval(p.timer)})),(e,a)=>{const l=C,t=Q,s=h,o=y;return n(),r("div",null,[w(be,{inputPass:x(p).isInputPass},null,8,["inputPass"]),w(o,{onSubmit:a[6]||(a[6]=T((()=>{}),["prevent"])),size:"small",model:x(f),ref_key:"refLoginForm",ref:m,"label-position":"right"},{default:_((()=>[w(s,{prop:"email",rules:{required:!0,type:"email",message:"邮箱格式不正确"}},{default:_((()=>[d("div",Ce,[w(l,{autocomplete:"off",maxlength:"40",modelValue:x(f).email,"onUpdate:modelValue":a[0]||(a[0]=e=>x(f).email=e),modelModifiers:{trim:!0},placeholder:"请输入邮箱"},null,8,["modelValue"]),w(t,{style:{width:"90px"},type:"primary",size:"small",class:"ml5",disabled:x(v)||"获取验证码"!=x(p).timerText,onClick:V},{default:_((()=>[A(j(x(p).timerText),1)])),_:1},8,["disabled"])])])),_:1}),w(s,{prop:"verifyKey",rules:{required:!0,message:"验证码不能为空"}},{default:_((()=>[w(l,{autocomplete:"off",maxlength:"6",modelValue:x(f).verifyKey,"onUpdate:modelValue":a[1]||(a[1]=e=>x(f).verifyKey=e),placeholder:"请输入6位邮箱验证码"},null,8,["modelValue"])])),_:1}),w(s,{prop:"username",rules:{required:!0,message:"请输入用户名"}},{default:_((()=>[w(l,{autocomplete:"off",maxlength:"18",modelValue:x(f).username,"onUpdate:modelValue":a[2]||(a[2]=e=>x(f).username=e),modelModifiers:{trim:!0},placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1}),w(s,{prop:"password",rules:{required:!0,message:"密码不能为空"}},{default:_((()=>[w(l,{autocomplete:"off",maxlength:"20","show-password":"",type:"password",onFocus:a[3]||(a[3]=e=>x(p).isInputPass=!0),onBlur:a[4]||(a[4]=e=>x(p).isInputPass=!1),modelValue:x(f).password,"onUpdate:modelValue":a[5]||(a[5]=e=>x(f).password=e),placeholder:"请输入8-18密码"},null,8,["modelValue"])])),_:1}),w(t,{loading:x(p).loading,onClick:I,type:"primary",class:"wfull"},{default:_((()=>[Pe])),_:1},8,["loading"])])),_:1},8,["model"])])}}};const De=e=>(p("data-v-31cecbac"),e=e(),f(),e),je={class:"app-login hfull"},qe=De((()=>d("h2",{class:"b f18 ac"},"欢迎使用iTab",-1))),Ue={class:"login-tip ac"},Be=A(" iTab可以使用 "),Se=De((()=>d("a",{class:"b",style:{color:"#0a79e1"},href:"https://codelife.cc/",target:"_blank"},"codelife.cc",-1))),Oe=A(" 账号登录 "),Le={key:0,class:"mt5"},Ee={class:"pl30 pr30 mb30"},Ke={key:0,class:"ac"},ze=A(" 还没有账号？ "),Me=A("立即注册"),Ne={key:1,class:"ac"},Re=A(" 已有账号？ "),He=A("立即登录");var Je=M({setup(e){const a=E(),l=g({loading:!1,activeName:"email"}),t=F((()=>a.loginInfo||{})),s=e=>{a.setLoginInfo(e)};return(e,a)=>{const o=Q,i=z,c=L;return n(),U(i,{"close-on-press-escape":!1,"close-on-click-modal":!1,fullscreenBtn:!1,width:"420px",height:"440px",modelValue:x(t).visible,"onUpdate:modelValue":a[2]||(a[2]=e=>x(t).visible=e)},{default:_((()=>[d("div",je,[qe,d("div",Ue,[Be,Se,Oe,"firefox"==x(K)()?(n(),r("p",Le," 火狐暂不支持第三方登陆 ")):B("",!0)]),d("div",Ee,[S(w(Ae,null,null,512),[[O,"login"==x(t).type]]),S(w(Fe,null,null,512),[[O,"reg"==x(t).type]]),"login"==x(t).type?S((n(),r("div",Ke,[ze,w(o,{type:"text",onClick:a[0]||(a[0]=e=>s("reg"))},{default:_((()=>[Me])),_:1})])),[[c,x(l).loading]]):B("",!0),"reg"==x(t).type?(n(),r("div",Ne,[Re,w(o,{type:"text",onClick:a[1]||(a[1]=e=>s("login"))},{default:_((()=>[He])),_:1})])):B("",!0)])])])),_:1},8,["modelValue"])}}},[["__scopeId","data-v-31cecbac"]]);export{Je as default};
